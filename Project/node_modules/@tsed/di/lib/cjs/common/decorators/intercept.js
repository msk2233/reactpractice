"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Intercept = void 0;
const core_1 = require("@tsed/core");
const constants_1 = require("../constants/constants");
const InjectablePropertyType_1 = require("../domain/InjectablePropertyType");
/**
 * Attaches interceptor to method call and executes the before and after methods
 *
 * @param interceptor
 * @param options
 * @decorator
 */
function Intercept(interceptor, options) {
    return (...args) => {
        const [target, propertyKey, descriptor] = args;
        const type = (0, core_1.decoratorTypeOf)(args);
        switch (type) {
            case core_1.DecoratorTypes.CLASS:
                (0, core_1.decorateMethodsOf)(target, Intercept(interceptor, options));
                break;
            case core_1.DecoratorTypes.METHOD:
                core_1.Store.from(target).merge(constants_1.INJECTABLE_PROP, {
                    [propertyKey]: {
                        options,
                        propertyKey,
                        useType: interceptor,
                        bindingType: InjectablePropertyType_1.InjectablePropertyType.INTERCEPTOR
                    }
                });
                return descriptor;
        }
    };
}
exports.Intercept = Intercept;
//# sourceMappingURL=intercept.js.map