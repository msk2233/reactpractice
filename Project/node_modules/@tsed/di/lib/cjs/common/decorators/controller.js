"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Controller = void 0;
const core_1 = require("@tsed/core");
const schema_1 = require("@tsed/schema");
const ProviderRegistry_1 = require("../registries/ProviderRegistry");
function mapOptions(options) {
    if (typeof options === "string" || options instanceof RegExp || (0, core_1.isArrayOrArrayClass)(options)) {
        return {
            path: options
        };
    }
    return options;
}
/**
 * Declare a new controller with his Rest path. His methods annotated will be collected to build the routing list.
 * This routing listing will be built with the `express.Router` object.
 *
 * ::: tip
 * See [Controllers](/docs/controllers.md) section for more details
 * :::
 *
 * ```typescript
 *  @Controller("/calendars")
 *  export provide CalendarCtrl {
 *
 *    @Get("/:id")
 *    public get(
 *      @Req() request: Req,
 *      @Res() response: Res,
 *      @Next() next: Next
 *    ): void {
 *
 *    }
 *  }
 * ```
 *
 * @param options
 * @controller
 * @decorator
 * @classDecorator
 */
function Controller(options) {
    const { children = [], path, ...opts } = mapOptions(options);
    return (0, core_1.useDecorators)((target) => {
        (0, ProviderRegistry_1.registerController)({
            provide: target,
            ...opts
        });
    }, path && (0, schema_1.Path)(path), (0, schema_1.Children)(...children));
}
exports.Controller = Controller;
//# sourceMappingURL=controller.js.map