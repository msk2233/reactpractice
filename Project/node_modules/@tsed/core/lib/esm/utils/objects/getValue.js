import { isFunction } from "./isFunction.js";
import { isObject } from "./isObject.js";
import { isString } from "./isString.js";
const mapOptions = (args) => {
    const [expression, scope, defaultValue, separator = "."] = args;
    if (isObject(scope) || isString(expression)) {
        return {
            expression,
            scope,
            defaultValue,
            separator
        };
    }
    return {
        expression: scope,
        scope: expression,
        defaultValue,
        separator
    };
};
export function getValue(...args) {
    const options = mapOptions(args);
    let scope = options.scope;
    const { expression, defaultValue, separator } = options;
    if (!expression) {
        return scope;
    }
    if (!scope) {
        return defaultValue;
    }
    const keys = expression.split(separator);
    const getValue = (key) => {
        if (scope) {
            if (scope[key] !== undefined || (isObject(scope) && key in scope)) {
                return scope[key];
            }
            if (isFunction(scope.get)) {
                return scope.get(key);
            }
        }
    };
    while ((scope = getValue(keys.shift())) && keys.length) { }
    return scope === undefined ? defaultValue : scope;
}
//# sourceMappingURL=getValue.js.map