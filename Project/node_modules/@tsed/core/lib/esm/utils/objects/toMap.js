import { isArray } from "./isArray.js";
import { isString } from "./isString.js";
function createIdentityFn(keyOrFn) {
    if (!keyOrFn) {
        return (v, k) => String(k);
    }
    if (isString(keyOrFn)) {
        return (item) => {
            return item[keyOrFn];
        };
    }
    return keyOrFn;
}
export function toMap(input, keyOrFn) {
    if (isArray(input)) {
        const identity = createIdentityFn(keyOrFn || "id");
        return input.reduce((map, value, index) => {
            const ids = [].concat(identity(value, index));
            ids.forEach((id) => {
                const item = map.get(id);
                value = item?.merge?.(value) || value;
                map.set(id, value);
            });
            return map;
        }, new Map());
    }
    const identity = createIdentityFn(keyOrFn);
    return Object.entries(input).reduce((map, [key, value]) => {
        return map.set(identity(value, key), value);
    }, new Map());
}
//# sourceMappingURL=toMap.js.map