"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.toMap = void 0;
const isArray_1 = require("./isArray");
const isString_1 = require("./isString");
function createIdentityFn(keyOrFn) {
    if (!keyOrFn) {
        return (v, k) => String(k);
    }
    if ((0, isString_1.isString)(keyOrFn)) {
        return (item) => {
            return item[keyOrFn];
        };
    }
    return keyOrFn;
}
function toMap(input, keyOrFn) {
    if ((0, isArray_1.isArray)(input)) {
        const identity = createIdentityFn(keyOrFn || "id");
        return input.reduce((map, value, index) => {
            const ids = [].concat(identity(value, index));
            ids.forEach((id) => {
                const item = map.get(id);
                value = item?.merge?.(value) || value;
                map.set(id, value);
            });
            return map;
        }, new Map());
    }
    const identity = createIdentityFn(keyOrFn);
    return Object.entries(input).reduce((map, [key, value]) => {
        return map.set(identity(value, key), value);
    }, new Map());
}
exports.toMap = toMap;
//# sourceMappingURL=toMap.js.map