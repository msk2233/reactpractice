"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getValue = void 0;
const isFunction_1 = require("./isFunction");
const isObject_1 = require("./isObject");
const isString_1 = require("./isString");
const mapOptions = (args) => {
    const [expression, scope, defaultValue, separator = "."] = args;
    if ((0, isObject_1.isObject)(scope) || (0, isString_1.isString)(expression)) {
        return {
            expression,
            scope,
            defaultValue,
            separator
        };
    }
    return {
        expression: scope,
        scope: expression,
        defaultValue,
        separator
    };
};
function getValue(...args) {
    const options = mapOptions(args);
    let scope = options.scope;
    const { expression, defaultValue, separator } = options;
    if (!expression) {
        return scope;
    }
    if (!scope) {
        return defaultValue;
    }
    const keys = expression.split(separator);
    const getValue = (key) => {
        if (scope) {
            if (scope[key] !== undefined || ((0, isObject_1.isObject)(scope) && key in scope)) {
                return scope[key];
            }
            if ((0, isFunction_1.isFunction)(scope.get)) {
                return scope.get(key);
            }
        }
    };
    while ((scope = getValue(keys.shift())) && keys.length) { }
    return scope === undefined ? defaultValue : scope;
}
exports.getValue = getValue;
//# sourceMappingURL=getValue.js.map