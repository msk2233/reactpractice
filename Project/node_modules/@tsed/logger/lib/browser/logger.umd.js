(function(a,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(a=typeof globalThis<"u"?globalThis:a||self,d(a["@tsed/logger"]={}))})(this,function(a){"use strict";var Et=Object.defineProperty;var At=(a,d,_)=>d in a?Et(a,d,{enumerable:!0,configurable:!0,writable:!0,value:_}):a[d]=_;var v=(a,d,_)=>(At(a,typeof d!="symbol"?d+"":d,_),_),Be=(a,d,_)=>{if(!d.has(a))throw TypeError("Cannot "+_)};var Ue=(a,d,_)=>(Be(a,d,"read from private field"),_?_.call(a):d.get(a)),Je=(a,d,_)=>{if(d.has(a))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(a):d.set(a,_)},me=(a,d,_,G)=>(Be(a,d,"write to private field"),G?G.call(a,_):d.set(a,_),_);var Z;const d=new Map;class _{static get(e,t){typeof e!="string"&&(e=e.$name),d.has(e)||(e="colored",console.warn(e+" layout doesn't exists"));const n=d.get(e);return new n.provide(t)}}class G{constructor(e){Je(this,Z,void 0);this.config=e,this.configure(e)}get appenderOptions(){return this.__proto__.constructor.$appenderOptions}configure(e){var t;return Object.assign(this.config,e),me(this,Z,_.get(((t=this.appenderOptions)==null?void 0:t.defaultLayout)||"colored",this.config)),this.config.layout&&me(this,Z,_.get(this.config.layout.type,this.config.layout)),this}layout(...e){return Ue(this,Z).transform(...e)}}Z=new WeakMap;const K=new Map;function ve(r){return e=>{e.$appenderOptions=r,e.$name=r.name,K.set(r.name,{provide:e})}}var He=Object.defineProperty,We=Object.getOwnPropertyDescriptor,Ze=(r,e,t,n)=>{for(var i=n>1?void 0:n?We(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&He(e,t,i),i};a.ConsoleAppender=class extends G{constructor(){super(...arguments);v(this,"log",console.log.bind(console))}write(t){this.log(this.layout(t,this.config.timezoneOffset))}},a.ConsoleAppender=Ze([ve({name:"console"})],a.ConsoleAppender);class Oe extends Map{toJSON(){return[...this.entries()].reduce((e,[t,n])=>({...e,[t]:n}),{})}}class be{constructor(e,t,n,i){v(this,"_startTime",new Date);this.categoryName=e,this.level=t,this.data=n,this.context=i}get startTime(){return this.data&&this.data[0]&&this.data[0].time?this.data[0].time:this._startTime}get formatedLevel(){return this.formattedLevel}get formattedLevel(){return(this.level.toString()+"     ").slice(0,5)}get cluster(){return{}}get pid(){return this.context.get("pid")}isMessage(){return this.data.length&&typeof this.data[0]!="object"}getData(){return this.isMessage()?{}:this.data[0]}getMessage(){return this.isMessage()?this.data:void 0}}class A{constructor(e,t){this.level=e,this.levelStr=t,this.level=e,this.levelStr=t}static getLevel(e,t){if(e instanceof A)return e;if(typeof e=="string"){const n=e.toUpperCase();return we[n]||t}return this.getLevel(e.toString())}toString(){return this.levelStr}isLessThanOrEqualTo(e){return typeof e=="string"&&(e=A.getLevel(e)),this.level<=e.level}isGreaterThanOrEqualTo(e){return typeof e=="string"&&(e=A.getLevel(e)),this.level>=e.level}isEqualTo(e){return typeof e=="string"&&(e=A.getLevel(e)),this.level===e.level}}const we={ALL:new A(Number.MIN_VALUE,"ALL"),TRACE:new A(5e3,"TRACE"),DEBUG:new A(1e4,"DEBUG"),INFO:new A(2e4,"INFO"),WARN:new A(3e4,"WARN"),ERROR:new A(4e4,"ERROR"),FATAL:new A(5e4,"FATAL"),MARK:new A(9007199254740992,"MARK"),OFF:new A(Number.MAX_VALUE,"OFF")};function R(){return we}class P{constructor(e){this.config=e}}var Ge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ve(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var _e={exports:{}};(function(r){function e(g,h){for(var S=g.toString();S.length<h;)S="0"+S;return S}function t(g){return e(g,2)}function n(g){var h=Math.abs(g),S=String(Math.floor(h/60)),T=String(h%60);return S=("0"+S).slice(-2),T=("0"+T).slice(-2),g===0?"Z":(g<0?"+":"-")+S+":"+T}function i(g,h){typeof g!="string"&&(h=g,g=r.exports.ISO8601_FORMAT),h||(h=r.exports.now());var S=t(h.getDate()),T=t(h.getMonth()+1),I=t(h.getFullYear()),B=t(I.substring(2,4)),U=g.indexOf("yyyy")>-1?I:B,j=t(h.getHours()),q=t(h.getMinutes()),J=t(h.getSeconds()),D=e(h.getMilliseconds(),3),p=n(h.getTimezoneOffset()),c=g.replace(/dd/g,S).replace(/MM/g,T).replace(/y{1,4}/g,U).replace(/hh/g,j).replace(/mm/g,q).replace(/ss/g,J).replace(/SSS/g,D).replace(/O/g,p);return c}function u(g,h,S,T){g["set"+(T?"":"UTC")+h](S)}function f(g,h,S){var T=g.indexOf("O")<0,I=!1,B=[{pattern:/y{1,4}/,regexp:"\\d{1,4}",fn:function(p,c){u(p,"FullYear",c,T)}},{pattern:/MM/,regexp:"\\d{1,2}",fn:function(p,c){u(p,"Month",c-1,T),p.getMonth()!==c-1&&(I=!0)}},{pattern:/dd/,regexp:"\\d{1,2}",fn:function(p,c){I&&u(p,"Month",p.getMonth()-1,T),u(p,"Date",c,T)}},{pattern:/hh/,regexp:"\\d{1,2}",fn:function(p,c){u(p,"Hours",c,T)}},{pattern:/mm/,regexp:"\\d\\d",fn:function(p,c){u(p,"Minutes",c,T)}},{pattern:/ss/,regexp:"\\d\\d",fn:function(p,c){u(p,"Seconds",c,T)}},{pattern:/SSS/,regexp:"\\d\\d\\d",fn:function(p,c){u(p,"Milliseconds",c,T)}},{pattern:/O/,regexp:"[+-]\\d{1,2}:?\\d{2}?|Z",fn:function(p,c){c==="Z"?c=0:c=c.replace(":","");var H=Math.abs(c),z=(c>0?-1:1)*(H%100+Math.floor(H/100)*60);p.setUTCMinutes(p.getUTCMinutes()+z)}}],U=B.reduce(function(p,c){return c.pattern.test(p.regexp)?(c.index=p.regexp.match(c.pattern).index,p.regexp=p.regexp.replace(c.pattern,"("+c.regexp+")")):c.index=-1,p},{regexp:g,index:[]}),j=B.filter(function(p){return p.index>-1});j.sort(function(p,c){return p.index-c.index});var q=new RegExp(U.regexp),J=q.exec(h);if(J){var D=S||r.exports.now();return j.forEach(function(p,c){p.fn(D,J[c+1])}),D}throw new Error("String '"+h+"' could not be parsed as '"+g+"'")}function L(g,h,S){if(!g)throw new Error("pattern must be supplied");return f(g,h,S)}function O(){return new Date}r.exports=i,r.exports.asString=i,r.exports.parse=L,r.exports.now=O,r.exports.ISO8601_FORMAT="yyyy-MM-ddThh:mm:ss.SSS",r.exports.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ss.SSSO",r.exports.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS",r.exports.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS"})(_e);var N=_e.exports,V=(r=>(r.ALL="grey",r.INFO="green",r.DEBUG="cyan",r.WARN="yellow",r.TRACE="blue",r.ERROR="red",r.FATAL="magenta",r.OFF="grey",r))(V||{});const Se={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};function ie(r){return r?`\x1B[${Se[r][0]}m`:""}function se(r){return r?`\x1B[${Se[r][1]}m`:""}function Te(r,e){return ie(e)+r+se(e)}function Ee(r){return r.replace(/\[\d+m|\\u\d+b/gi,"")}function Ae(r,e){let t;return r?(t=parseInt(r.substr(1),10),e.substring(0,t)):e}function Me(r,e){let t;if(r)if(r.charAt(0)==="-")for(t=parseInt(r.substr(1),10);e.length<t;)e+=" ";else for(t=parseInt(r,10);e.length<t;)e=` ${e}`;return e}function Le(r,e,t){let n=r;return n=Ae(e,n),n=Me(t,n),n}function je(r,...e){const t=/(%?)(%([ojds]))/g;if(e.length){const n=(i,u,f,L)=>{let O=e.shift();switch(L){case"o":if(Array.isArray(O)){O=JSON.stringify(O);break}case"s":O=""+O;break;case"d":O=Number(O);break;case"j":O=JSON.stringify(O);break}return u?(e.unshift(O),i):O};r=String(r).replace(t,n)}return e.length&&(r+=" "+e.join(" ")),r=String(r).replace(/%{2,2}/g,"%"),""+r}const F=class F{constructor(e,t){v(this,"categoryName",(e,t)=>{let n=e.categoryName;if(t){const i=parseInt(t,10),u=n.split(".");i<u.length&&(n=u.slice(u.length-i).join("."))}return n});v(this,"formatAsDate",(e,t)=>{let n=N.ISO8601_FORMAT;return t&&(n=t,n==="ISO8601"?n=N.ISO8601_FORMAT:n==="ISO8601_WITH_TZ_OFFSET"?n=N.ISO8601_WITH_TZ_OFFSET_FORMAT:n==="ABSOLUTE"?n=N.ABSOLUTETIME_FORMAT:n==="DATE"&&(n=N.DATETIME_FORMAT)),N.asString(n,e.startTime,this.timezoneOffset)});v(this,"hostname",()=>F.HOSTNAME||"");v(this,"formatMessage",e=>F.formatter(...e.data));v(this,"formatJson",e=>JSON.stringify(e.data));v(this,"endOfLine",()=>F.EOL);v(this,"logLevel",e=>e.level.toString());v(this,"startTime",e=>N.asString("hh:mm:ss",e.startTime,this.timezoneOffset));v(this,"startColour",e=>{const t=e.level.toString();return ie(V[t])});v(this,"endColour",e=>{const t=e.level.toString();return se(V[t])});v(this,"percent",()=>"%");v(this,"pid",e=>e&&e.pid?e.pid.toString():process.pid.toString());v(this,"clusterInfo",(e,t)=>e.cluster&&t?t.replace("%m",e.cluster.master).replace("%w",e.cluster.worker).replace("%i",e.cluster.workerId):e.cluster?`${e.cluster.worker}@${e.cluster.master}`:this.pid());v(this,"userDefined",(e,t)=>typeof this.tokens[t]<"u"?typeof this.tokens[t]=="function"?this.tokens[t](e):this.tokens[t]:null);this.tokens=e,this.timezoneOffset=t}build(){return{c:this.categoryName,d:this.formatAsDate,h:this.hostname,m:this.formatMessage,j:this.formatJson,n:this.endOfLine,p:this.logLevel,r:this.startTime,"[":this.startColour,"]":this.endColour,y:this.clusterInfo,z:this.pid,"%":this.percent,x:this.userDefined}}};v(F,"EOL",`
`),v(F,"HOSTNAME",""),v(F,"formatter",je);let X=F;var W={},Ye=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"},oe={exports:{}};typeof Object.create=="function"?oe.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:oe.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var qe=oe.exports;(function(r){var e=/%[sdj%]/g;r.format=function(s){if(!D(s)){for(var o=[],l=0;l<arguments.length;l++)o.push(i(arguments[l]));return o.join(" ")}for(var l=1,m=arguments,M=m.length,b=String(s).replace(e,function(w){if(w==="%%")return"%";if(l>=M)return w;switch(w){case"%s":return String(m[l++]);case"%d":return Number(m[l++]);case"%j":try{return JSON.stringify(m[l++])}catch{return"[Circular]"}default:return w}}),y=m[l];l<M;y=m[++l])j(y)||!z(y)?b+=" "+y:b+=" "+i(y);return b},r.deprecate=function(s,o){if(c(Ge.process))return function(){return r.deprecate(s,o).apply(this,arguments)};if(process.noDeprecation===!0)return s;var l=!1;function m(){if(!l){if(process.throwDeprecation)throw new Error(o);process.traceDeprecation?console.trace(o):console.error(o),l=!0}return s.apply(this,arguments)}return m};var t={},n;r.debuglog=function(s){if(c(n)&&(n=process.env.NODE_DEBUG||""),s=s.toUpperCase(),!t[s])if(new RegExp("\\b"+s+"\\b","i").test(n)){var o=process.pid;t[s]=function(){var l=r.format.apply(r,arguments);console.error("%s %d: %s",s,o,l)}}else t[s]=function(){};return t[s]};function i(s,o){var l={seen:[],stylize:f};return arguments.length>=3&&(l.depth=arguments[2]),arguments.length>=4&&(l.colors=arguments[3]),U(o)?l.showHidden=o:o&&r._extend(l,o),c(l.showHidden)&&(l.showHidden=!1),c(l.depth)&&(l.depth=2),c(l.colors)&&(l.colors=!1),c(l.customInspect)&&(l.customInspect=!0),l.colors&&(l.stylize=u),O(l,s,l.depth)}r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function u(s,o){var l=i.styles[o];return l?"\x1B["+i.colors[l][0]+"m"+s+"\x1B["+i.colors[l][1]+"m":s}function f(s,o){return s}function L(s){var o={};return s.forEach(function(l,m){o[l]=!0}),o}function O(s,o,l){if(s.customInspect&&o&&re(o.inspect)&&o.inspect!==r.inspect&&!(o.constructor&&o.constructor.prototype===o)){var m=o.inspect(l,s);return D(m)||(m=O(s,m,l)),m}var M=g(s,o);if(M)return M;var b=Object.keys(o),y=L(b);if(s.showHidden&&(b=Object.getOwnPropertyNames(o)),te(o)&&(b.indexOf("message")>=0||b.indexOf("description")>=0))return h(o);if(b.length===0){if(re(o)){var w=o.name?": "+o.name:"";return s.stylize("[Function"+w+"]","special")}if(H(o))return s.stylize(RegExp.prototype.toString.call(o),"regexp");if(he(o))return s.stylize(Date.prototype.toString.call(o),"date");if(te(o))return h(o)}var E="",$=!1,ne=["{","}"];if(B(o)&&($=!0,ne=["[","]"]),re(o)){var St=o.name?": "+o.name:"";E=" [Function"+St+"]"}if(H(o)&&(E=" "+RegExp.prototype.toString.call(o)),he(o)&&(E=" "+Date.prototype.toUTCString.call(o)),te(o)&&(E=" "+h(o)),b.length===0&&(!$||o.length==0))return ne[0]+E+ne[1];if(l<0)return H(o)?s.stylize(RegExp.prototype.toString.call(o),"regexp"):s.stylize("[Object]","special");s.seen.push(o);var ge;return $?ge=S(s,o,l,y,b):ge=b.map(function(Tt){return T(s,o,l,y,Tt,$)}),s.seen.pop(),I(ge,E,ne)}function g(s,o){if(c(o))return s.stylize("undefined","undefined");if(D(o)){var l="'"+JSON.stringify(o).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return s.stylize(l,"string")}if(J(o))return s.stylize(""+o,"number");if(U(o))return s.stylize(""+o,"boolean");if(j(o))return s.stylize("null","null")}function h(s){return"["+Error.prototype.toString.call(s)+"]"}function S(s,o,l,m,M){for(var b=[],y=0,w=o.length;y<w;++y)Ie(o,String(y))?b.push(T(s,o,l,m,String(y),!0)):b.push("");return M.forEach(function(E){E.match(/^\d+$/)||b.push(T(s,o,l,m,E,!0))}),b}function T(s,o,l,m,M,b){var y,w,E;if(E=Object.getOwnPropertyDescriptor(o,M)||{value:o[M]},E.get?E.set?w=s.stylize("[Getter/Setter]","special"):w=s.stylize("[Getter]","special"):E.set&&(w=s.stylize("[Setter]","special")),Ie(m,M)||(y="["+M+"]"),w||(s.seen.indexOf(E.value)<0?(j(l)?w=O(s,E.value,null):w=O(s,E.value,l-1),w.indexOf(`
`)>-1&&(b?w=w.split(`
`).map(function($){return"  "+$}).join(`
`).substr(2):w=`
`+w.split(`
`).map(function($){return"   "+$}).join(`
`))):w=s.stylize("[Circular]","special")),c(y)){if(b&&M.match(/^\d+$/))return w;y=JSON.stringify(""+M),y.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(y=y.substr(1,y.length-2),y=s.stylize(y,"name")):(y=y.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),y=s.stylize(y,"string"))}return y+": "+w}function I(s,o,l){var m=s.reduce(function(M,b){return b.indexOf(`
`)>=0,M+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return m>60?l[0]+(o===""?"":o+`
 `)+" "+s.join(`,
  `)+" "+l[1]:l[0]+o+" "+s.join(", ")+" "+l[1]}function B(s){return Array.isArray(s)}r.isArray=B;function U(s){return typeof s=="boolean"}r.isBoolean=U;function j(s){return s===null}r.isNull=j;function q(s){return s==null}r.isNullOrUndefined=q;function J(s){return typeof s=="number"}r.isNumber=J;function D(s){return typeof s=="string"}r.isString=D;function p(s){return typeof s=="symbol"}r.isSymbol=p;function c(s){return s===void 0}r.isUndefined=c;function H(s){return z(s)&&de(s)==="[object RegExp]"}r.isRegExp=H;function z(s){return typeof s=="object"&&s!==null}r.isObject=z;function he(s){return z(s)&&de(s)==="[object Date]"}r.isDate=he;function te(s){return z(s)&&(de(s)==="[object Error]"||s instanceof Error)}r.isError=te;function re(s){return typeof s=="function"}r.isFunction=re;function bt(s){return s===null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||typeof s=="symbol"||typeof s>"u"}r.isPrimitive=bt,r.isBuffer=Ye;function de(s){return Object.prototype.toString.call(s)}function ye(s){return s<10?"0"+s.toString(10):s.toString(10)}var wt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _t(){var s=new Date,o=[ye(s.getHours()),ye(s.getMinutes()),ye(s.getSeconds())].join(":");return[s.getDate(),wt[s.getMonth()],o].join(" ")}r.log=function(){console.log("%s - %s",_t(),r.format.apply(r,arguments))},r.inherits=qe,r._extend=function(s,o){if(!o||!z(o))return s;for(var l=Object.keys(o),m=l.length;m--;)s[l[m]]=o[l[m]];return s};function Ie(s,o){return Object.prototype.hasOwnProperty.call(s,o)}})(W);const Ke=Ve(W);function ae(r,e,t){return Te(W.format("[%s] [%s] [%s] - ",N.asString(r.startTime,t),r.formattedLevel,r.categoryName),e)}function C(r){return e=>{e.$name=r.name,d.set(r.name,{provide:e})}}var Xe=Object.defineProperty,Qe=Object.getOwnPropertyDescriptor,ke=(r,e,t,n)=>{for(var i=n>1?void 0:n?Qe(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&Xe(e,t,i),i};a.BasicLayout=class extends P{transform(e,t){return ae(e,void 0,t)+W.format(...[].concat(e.data))}},a.BasicLayout=ke([C({name:"basic"})],a.BasicLayout);var xe=Object.defineProperty,et=Object.getOwnPropertyDescriptor,tt=(r,e,t,n)=>{for(var i=n>1?void 0:n?et(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&xe(e,t,i),i};a.ColoredLayout=class extends P{transform(e,t){const n=e.level.toString(),i=V[n];return ae(e,i,t)+W.format(...[].concat(e.data))}},a.ColoredLayout=tt([C({name:"colored"})],a.ColoredLayout);var rt=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,it=(r,e,t,n)=>{for(var i=n>1?void 0:n?nt(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&rt(e,t,i),i};a.DummyLayout=class extends P{transform(e,t){return e.data[0]}},a.DummyLayout=it([C({name:"dummy"})],a.DummyLayout);function ue(r){const e={...r.context.toJSON(),startTime:r.startTime,categoryName:r.categoryName,level:r.level.toString()};return e.data=r.data.reduce((t,n)=>typeof n=="object"?(Object.assign(e,n),n.data?[].concat(t,n.data):t):[...t,Ee(Ke.format(n))],[]),e}var st=Object.defineProperty,ot=Object.getOwnPropertyDescriptor,at=(r,e,t,n)=>{for(var i=n>1?void 0:n?ot(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&st(e,t,i),i};a.JsonLayout=class extends P{transform(e,t){const n=ue(e);return JSON.stringify(n)+(this.config.separator||"")}},a.JsonLayout=at([C({name:"json"})],a.JsonLayout);var ut=Object.defineProperty,lt=Object.getOwnPropertyDescriptor,ct=(r,e,t,n)=>{for(var i=n>1?void 0:n?lt(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&ut(e,t,i),i};a.MessagePassThroughLayout=class extends P{transform(e,t){return W.format(...[].concat(e.data))}},a.MessagePassThroughLayout=ct([C({name:"messagePassThrough"})],a.MessagePassThroughLayout);var ft=Object.defineProperty,pt=Object.getOwnPropertyDescriptor,ht=(r,e,t,n)=>{for(var i=n>1?void 0:n?pt(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&ft(e,t,i),i};a.ObjectLayout=class extends P{transform(e,t){return ue(e)}},a.ObjectLayout=ht([C({name:"object"})],a.ObjectLayout);var De=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,yt=(r,e,t)=>e in r?De(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,gt=(r,e,t,n)=>{for(var i=n>1?void 0:n?dt(e,t):e,u=r.length-1,f;u>=0;u--)(f=r[u])&&(i=(n?f(e,t,i):f(i))||i);return n&&i&&De(e,t,i),i},mt=(r,e,t)=>(yt(r,typeof e!="symbol"?e+"":e,t),t),Pe=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)},le=(r,e,t)=>(Pe(r,e,"read from private field"),t?t.call(r):e.get(r)),ce=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},fe=(r,e,t,n)=>(Pe(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Q,k,x;const vt=/%(-?[0-9]+)?(\.?[0-9]+)?([[\]cdhmnpjrzxy%])(\{([^}]+)\})?|([^%]+)/,Ot="%r %p %c - %m%n";a.PatternLayout=class extends P{constructor(e){super(e),ce(this,Q,void 0),ce(this,k,void 0),ce(this,x,void 0),mt(this,"replaceToken",(t,n,i)=>le(this,Q)[t](n,i)),fe(this,x,e&&e.pattern||Ot),fe(this,k,e&&e.tokens),fe(this,Q,new X(le(this,k),this.config.timezoneOffset).build())}transform(e,t){let n="",i,u=le(this,x);for(;(i=vt.exec(u))!==null;){const f=i[1],L=i[2],O=i[3],g=i[5],h=i[6];if(h)n+=h.toString();else{const S=this.replaceToken(O,e,g);n+=Le(S,L,f)}u=u.substr(i.index+i[0].length)}return n}},Q=new WeakMap,k=new WeakMap,x=new WeakMap,a.PatternLayout=gt([C({name:"pattern"})],a.PatternLayout);class Ne{constructor(){v(this,"_appenders",new Map);v(this,"_lvls",new Map)}get size(){return this._appenders.size}has(e){return this._appenders.has(e)}get(e){return this._appenders.get(e)}set(e,t){var L;const n=typeof t.type=="string"?t.type:(L=t.type)==null?void 0:L.$name,i={level:["debug","info","trace","error","warn","fatal"],...t,type:n,options:t.options||{}};if(!K.has(i.type)){const O=new Error(`Appender ${i.type} doesn't exists. Check your configuration:
${JSON.stringify(i)}
`);throw O.name="UNKNOW_APPENDER",O}const u=K.get(i.type).provide,f=new u(i);return"build"in f&&f.build(),this._appenders.set(e,{name:e,instance:f,config:i}),this._lvls.clear(),this}delete(e){let t=this._appenders.delete(e);return t&&this._lvls.clear(),t}clear(){this._appenders.clear(),this._lvls.clear()}forEach(e,t){this._appenders.forEach(e,t)}toArray(){const e=[];return this._appenders.forEach(t=>e.push(t)),e}byLogLevel(e){const t=e.toString();if(this._lvls.has(t))return this._lvls.get(t);const n=this.toArray().filter(i=>i.config.levels?i.config.levels.find(u=>u.toUpperCase()===e.toString()):!0).map(i=>i.instance);return this._lvls.set(e.toString(),n),n}}function Y(r,e=" "){let t="";for(;r--;)t+=e;return t}function Ce(r,e){let t="┌",n=Object.keys(r);return n.forEach((i,u)=>{u!==0&&u!==n.length&&(t+="┬"),t+=Y(r[i]+2*e.padding,"─")}),t+="┐",t}function Fe(r,e){let t="└",n=Object.keys(r);return n.forEach((i,u)=>{u!==0&&u!==n.length&&(t+="┴"),t+=Y(r[i]+2*e.padding,"─")}),t+="┘",t}function ze(r,e,t="─"){let n="";return Object.keys(r).forEach(i=>{n+="│",n+=Y(r[i]+2*e.padding,t)}),n+="│",n}function pe(r,e,t){let n="";return Object.keys(e).forEach(i=>{n+="│ ",n+=r[i],n+=Y(e[i]+2*(t.padding-1)-r[i].length," "),n+=" "}),n+="│",n}function $e(r,e={}){e.padding=e.padding||1,e.header===void 0&&(e.header={},Object.keys(r[0]).forEach(i=>e.header[i]=i));const t={};Object.keys(e.header).forEach(i=>t[i]=e.header[i].length),r.forEach(i=>{Object.keys(t).forEach(u=>t[u]=Math.max((""+i[u]).length,t[u]))});let n="";return n+=Ce(t,e)+`
`,n+=pe(e.header,t,e)+`
`,r.forEach(i=>{n+=ze(t,e)+`
`,n+=pe(i,t,e)+`
`}),n+=Fe(t,e),n}class ee{constructor(e="default"){v(this,"_appenders",new Ne);v(this,"_level");v(this,"_context",new Oe);this._name=e,this.level="all"}get appenders(){return this._appenders}get level(){return this._level.toString()}set level(e){this._level=A.getLevel(e,"debug")}get context(){return this._context}get name(){return this._name}set name(e){this._name=e}static createStack(){return new Error().stack.replace(`Error
`,"").split(`
`).filter((t,n)=>n>=2).join(`
`)}isLevelEnabled(e){return this._level.isLessThanOrEqualTo(e)}debug(...e){return this.write(R().DEBUG,e)}info(...e){return this.write(R().INFO,e)}warn(...e){return this.write(R().WARN,e)}error(...e){return this.write(R().ERROR,e)}fatal(...e){return this.write(R().FATAL,e)}trace(...e){const t=`
`+ee.createStack()+`
`;return e.push(t),this.write(R().TRACE,e)}start(){return this.level="ALL",this}stop(){return this.level="OFF",this}shutdown(){this.stop();const e=this.appenders.toArray().filter(t=>!!t.instance.shutdown).map(t=>t.instance.shutdown());return Promise.all(e)}drawTable(e,t={}){return $e(e,t)}printTable(e,t={}){return this.info(`
${this.drawTable(e,t)}`),this}write(e,t){if(!this.isLevelEnabled(e))return this;const n=new be(this._name,e,t,this._context);return this.appenders.byLogLevel(e).forEach(i=>{i.write(n)}),this}}const Re=new ee("default");Re.appenders.set("console",{type:"console",levels:["info","debug","trace","fatal","error","warn"]}),a.$log=Re,a.Appender=ve,a.AppendersRegistry=K,a.BaseAppender=G,a.BaseLayout=P,a.LOG_COLORS=V,a.Layout=C,a.LayoutReplacer=X,a.Layouts=_,a.LayoutsRegistry=d,a.LogContext=Oe,a.LogEvent=be,a.LogLevel=A,a.Logger=ee,a.LoggerAppenders=Ne,a.buildEndLine=Fe,a.buildLine=ze,a.buildLineData=pe,a.buildStartLine=Ce,a.charRepeater=Y,a.colorize=Te,a.colorizeEnd=se,a.colorizeStart=ie,a.drawTable=$e,a.format=je,a.levels=R,a.logEventToObject=ue,a.pad=Me,a.removeColors=Ee,a.timestampLevelAndCategory=ae,a.truncate=Ae,a.truncateAndPad=Le,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
