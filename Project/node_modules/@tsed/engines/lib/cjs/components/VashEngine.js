"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.VashEngine = void 0;
const tslib_1 = require("tslib");
const util_1 = require("util");
const viewEngine_1 = require("../decorators/viewEngine");
const Engine_1 = require("./Engine");
let VashEngine = class VashEngine extends Engine_1.Engine {
    compile(template, options) {
        if (options.helpers) {
            for (const key in options.helpers) {
                if (!options.helpers.hasOwnProperty(key) || typeof options.helpers[key] !== "function") {
                    continue;
                }
                this.engine.helpers[key] = options.helpers[key];
            }
        }
        const compile = (0, util_1.promisify)(this.engine.compile(template, options));
        return async (options) => {
            const ctx = await compile(options);
            ctx.finishLayout();
            return ctx.toString();
        };
    }
    async render(template, options) {
        const compile = this.compile(template, options);
        const tpl = await compile(options);
        return tpl.replace(/\n$/, "");
    }
};
VashEngine = tslib_1.__decorate([
    (0, viewEngine_1.ViewEngine)("vash")
], VashEngine);
exports.VashEngine = VashEngine;
//# sourceMappingURL=VashEngine.js.map