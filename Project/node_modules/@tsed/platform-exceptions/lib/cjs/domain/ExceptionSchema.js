"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const Exceptions = tslib_1.__importStar(require("@tsed/exceptions"));
const exceptions_1 = require("@tsed/exceptions");
const schema_1 = require("@tsed/schema");
/**
 * @ignore
 */
const ErrorSchema = (0, schema_1.object)({
    name: (0, schema_1.string)().required().description("The error name"),
    message: (0, schema_1.string)().required().description("An error message")
})
    .label("GenericError")
    .unknown();
(0, schema_1.from)(exceptions_1.Exception).properties({
    name: (0, schema_1.string)().required().description("The error name"),
    message: (0, schema_1.string)().required().description("An error message"),
    status: (0, schema_1.number)().required().description("The status code of the exception"),
    errors: (0, schema_1.array)().items(ErrorSchema).description("A list of related errors"),
    stack: (0, schema_1.string)().description("The stack trace (only in development mode)")
});
// Auto load models for all Exceptions
Object.values(Exceptions).forEach((target) => {
    if (target !== exceptions_1.Exception && target.STATUS) {
        if (target.STATUS > 302) {
            const name = (0, schema_1.getStatusConstant)(target.STATUS);
            (0, schema_1.from)(target).properties({
                name: (0, schema_1.string)().required().example(name).default(name).description("The error name"),
                status: (0, schema_1.number)().required().example(target.STATUS).default(target.STATUS).description("The status code of the exception")
            });
            (0, schema_1.defineStatusModel)(target.STATUS, target);
        }
    }
});
//# sourceMappingURL=ExceptionSchema.js.map